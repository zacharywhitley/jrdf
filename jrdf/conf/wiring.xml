<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE beans PUBLIC "-//SPRING//DTD BEAN//EN"
    "http://www.springframework.org/dtd/spring-beans.dtd">

<beans>
    <!-- Graph Classes -->
    <bean class="org.jrdf.graph.index.longindex.mem.LongIndexMem" singleton="false">
    </bean>

    <bean class="org.jrdf.graph.index.nodepool.mem.NodePoolMemImpl" singleton="false">
    </bean>

    <bean id="graphFactory" class="org.jrdf.graph.mem.OrderedGraphFactoryImpl" singleton="false">
        <constructor-arg>
            <list>
                <ref bean="org.jrdf.graph.index.longindex.mem.LongIndexMem"/>
                <ref bean="org.jrdf.graph.index.longindex.mem.LongIndexMem"/>
                <ref bean="org.jrdf.graph.index.longindex.mem.LongIndexMem"/>
            </list>
        </constructor-arg>
        <constructor-arg ref="org.jrdf.graph.index.nodepool.mem.NodePoolMemImpl"/>
        <constructor-arg>
            <ref bean="nodeComparator"/>
        </constructor-arg>
    </bean>

    <!-- Relational Classes -->
    <bean id="nodeTypeComparator" class="org.jrdf.util.NodeTypeComparatorImpl"/>

    <bean id="typeComparator" class="org.jrdf.query.relation.type.TypeComparatorImpl">
        <constructor-arg>
            <ref bean="nodeTypeComparator"/>
        </constructor-arg>
    </bean>

    <bean id="attributeNameComparator" class="org.jrdf.query.relation.attributename.AttributeNameComparatorImpl"/>

    <bean id="attributeComparator" class="org.jrdf.query.relation.mem.AttributeComparatorImpl">
        <constructor-arg>
            <ref bean="typeComparator"/>
        </constructor-arg>
        <constructor-arg>
            <ref bean="attributeNameComparator"/>
        </constructor-arg>
    </bean>

    <bean id="nodeComparator" class="org.jrdf.graph.mem.NodeComparatorImpl">
        <constructor-arg>
            <ref bean="nodeTypeComparator"/>
        </constructor-arg>
    </bean>

    <bean id="avpComparator" class="org.jrdf.query.relation.mem.AttributeValuePairComparatorImpl">
        <constructor-arg>
            <ref bean="nodeComparator"/>
        </constructor-arg>
        <constructor-arg>
            <ref bean="attributeComparator"/>
        </constructor-arg>
    </bean>

    <bean id="tupleComparator" class="org.jrdf.query.relation.mem.TupleComparatorImpl">
        <constructor-arg>
            <ref bean="avpComparator"/>
        </constructor-arg>
    </bean>

    <bean id="tupleFactory" class="org.jrdf.query.relation.mem.TupleFactoryImpl">
        <constructor-arg>
            <ref bean="avpComparator"/>
        </constructor-arg>
    </bean>

    <bean id="relationComparator" class="org.jrdf.query.relation.mem.RelationComparatorImpl">
        <constructor-arg>
            <ref bean="attributeComparator"/>
        </constructor-arg>
        <constructor-arg>
            <ref bean="tupleComparator"/>
        </constructor-arg>
    </bean>

    <bean id="relationFactory" class="org.jrdf.query.relation.mem.RelationFactoryImpl">
        <constructor-arg>
            <ref bean="attributeComparator"/>
        </constructor-arg>
        <constructor-arg>
            <ref bean="tupleComparator"/>
        </constructor-arg>
    </bean>

    <!-- Query Classes -->
    <bean id="sparqlConnection" class="org.jrdf.sparql.SparqlConnectionImpl">
        <constructor-arg type="java.net.URL">
            <value>http://jrdf.sf.net/connection#NO_SECURITY</value>
        </constructor-arg>
        <constructor-arg>
            <ref bean="queryBuilder"/>
        </constructor-arg>
        <constructor-arg>
            <ref bean="queryEngine"/>
        </constructor-arg>
    </bean>

    <bean id="queryBuilder" class="org.jrdf.sparql.builder.SparqlQueryBuilder">
        <constructor-arg>
            <ref bean="sparqlParser"/>
        </constructor-arg>
    </bean>

    <bean id="sparqlParser" class="org.jrdf.sparql.parser.SableCcSparqlParser">
        <constructor-arg>
            <ref bean="parserFactory"/>
        </constructor-arg>
        <constructor-arg>
            <ref bean="graphRelationFactory"/>
        </constructor-arg>
        <constructor-arg>
            <ref bean="sortedAttributeValuePairHelper"/>
        </constructor-arg>
        <constructor-arg>
            <ref bean="sortedAttributeFactory"/>
        </constructor-arg>
    </bean>

    <bean id="parserFactory" class="org.jrdf.sparql.parser.ParserFactoryImpl"/>

    <bean id="queryEngine" class="org.jrdf.query.execute.NaiveQueryEngineImpl">
        <constructor-arg>
            <ref bean="project"/>
        </constructor-arg>
        <constructor-arg>
            <ref bean="naturalJoin"/>
        </constructor-arg>
        <constructor-arg>
            <ref bean="restrict"/>
        </constructor-arg>
        <constructor-arg>
            <ref bean="outerUnion"/>
        </constructor-arg>
        <constructor-arg>
            <ref bean="minleftOuterJoin"/>
        </constructor-arg>
    </bean>

    <!-- Relational Operations and Supporting Classes -->
    <bean id="sortedAttributeFactory" class="org.jrdf.query.relation.mem.SortedAttributeFactoryImpl">
        <constructor-arg>
            <ref bean="attributeComparator"/>
        </constructor-arg>
        <constructor-arg>
            <value>1</value>
        </constructor-arg>
    </bean>

    <bean id="sortedAttributeValuePairHelper" class="org.jrdf.query.relation.mem.SortedAttributeValuePairHelperImpl">
        <constructor-arg>
            <ref bean="sortedAttributeFactory"/>
        </constructor-arg>
        <constructor-arg>
            <ref bean="avpComparator"/>
        </constructor-arg>
    </bean>

    <bean id="graphRelationFactory" class="org.jrdf.query.relation.mem.GraphRelationFactoryImpl">
        <constructor-arg>
            <ref bean="sortedAttributeFactory"/>
        </constructor-arg>
        <constructor-arg>
            <ref bean="sortedAttributeValuePairHelper"/>
        </constructor-arg>
        <constructor-arg>
            <ref bean="tupleComparator"/>
        </constructor-arg>
        <constructor-arg>
            <ref bean="tupleFactory"/>
        </constructor-arg>
    </bean>

    <bean id="mergeHeadings" class="org.jrdf.query.relation.operation.mem.project.MergeHeadingsImpl">
        <constructor-arg>
            <ref bean="tupleFactory"/>
        </constructor-arg>
        <constructor-arg>
            <ref bean="relationFactory"/>
        </constructor-arg>
    </bean>

    <!-- Relational Operators -->
    <bean id="relationHelper" class="org.jrdf.query.relation.mem.RelationHelperImpl">
        <constructor-arg>
            <ref bean="attributeComparator"/>
        </constructor-arg>
    </bean>

    <bean id="relationProcessor" class="org.jrdf.query.relation.operation.mem.common.RelationProcessorImpl">
        <constructor-arg>
            <ref bean="relationFactory"/>
        </constructor-arg>
        <constructor-arg>
            <ref bean="tupleComparator"/>
        </constructor-arg>
    </bean>

    <bean id="naturalJoinEngine" class="org.jrdf.query.relation.operation.mem.join.natural.NaturalJoinEngine">
        <constructor-arg>
            <ref bean="tupleFactory"/>
        </constructor-arg>
        <constructor-arg>
            <ref bean="avpComparator"/>
        </constructor-arg>
        <constructor-arg>
            <ref bean="relationHelper"/>
        </constructor-arg>
    </bean>

    <bean id="semiJoinEngine" class="org.jrdf.query.relation.operation.mem.join.semi.SemiJoinEngine">
        <constructor-arg>
            <ref bean="tupleFactory"/>
        </constructor-arg>
        <constructor-arg>
            <ref bean="avpComparator"/>
        </constructor-arg>
    </bean>

    <bean id="outerUnionJoinEngine" class="org.jrdf.query.relation.operation.mem.union.OuterUnionEngine">
        <constructor-arg>
            <ref bean="tupleFactory"/>
        </constructor-arg>
        <constructor-arg>
            <ref bean="avpComparator"/>
        </constructor-arg>
        <constructor-arg>
            <ref bean="relationHelper"/>
        </constructor-arg>
    </bean>

    <bean id="subsumptionJoinEngine" class="org.jrdf.query.relation.operation.mem.union.SubsumptionEngine">
        <constructor-arg>
            <ref bean="tupleFactory"/>
        </constructor-arg>
        <constructor-arg>
            <ref bean="relationHelper"/>
        </constructor-arg>
    </bean>

    <bean id="naturalJoin" class="org.jrdf.query.relation.operation.mem.join.NadicJoinImpl">
        <constructor-arg>
            <ref bean="relationProcessor"/>
        </constructor-arg>
        <constructor-arg>
            <ref bean="naturalJoinEngine"/>
        </constructor-arg>
    </bean>

    <bean id="semiJoin" class="org.jrdf.query.relation.operation.mem.join.semi.SemiJoinImpl">
        <constructor-arg>
            <ref bean="relationProcessor"/>
        </constructor-arg>
        <constructor-arg>
            <ref bean="semiJoinEngine"/>
        </constructor-arg>
    </bean>

    <bean id="project" class="org.jrdf.query.relation.operation.mem.project.ProjectImpl">
        <constructor-arg>
            <ref bean="tupleFactory"/>
        </constructor-arg>
        <constructor-arg>
            <ref bean="relationFactory"/>
        </constructor-arg>
        <constructor-arg>
            <ref bean="mergeHeadings"/>
        </constructor-arg>
    </bean>

    <bean id="restrict" class="org.jrdf.query.relation.operation.mem.restrict.RestrictImpl">
        <constructor-arg>
            <ref bean="relationFactory"/>
        </constructor-arg>
    </bean>

    <bean id="outerUnion" class="org.jrdf.query.relation.operation.mem.union.OuterUnionImpl">
        <constructor-arg>
            <ref bean="relationProcessor"/>
        </constructor-arg>
        <constructor-arg>
            <ref bean="outerUnionJoinEngine"/>
        </constructor-arg>
    </bean>

    <bean id="minimumUnion" class="org.jrdf.query.relation.operation.mem.union.MinimumUnionImpl">
        <constructor-arg>
            <ref bean="relationProcessor"/>
        </constructor-arg>
        <constructor-arg>
            <ref bean="outerUnionJoinEngine"/>
        </constructor-arg>
        <constructor-arg>
            <ref bean="subsumptionJoinEngine"/>
        </constructor-arg>
    </bean>

    <bean id="semiDifference" class="org.jrdf.query.relation.operation.mem.semidifference.SemiDifferenceImpl">
        <constructor-arg>
             <ref bean="relationFactory"/>
         </constructor-arg>
        <constructor-arg>
             <ref bean="tupleComparator"/>
         </constructor-arg>
     </bean>

    <bean id="antiJoin" class="org.jrdf.query.relation.operation.mem.join.anti.AntiJoinImpl">
        <constructor-arg>
            <ref bean="semiJoin"/>
        </constructor-arg>
        <constructor-arg>
            <ref bean="semiDifference"/>
        </constructor-arg>
    </bean>

    <bean id="leftOuterJoin" class="org.jrdf.query.relation.operation.mem.join.outer.LeftOuterJoinImpl">
        <constructor-arg>
            <ref bean="antiJoin"/>
        </constructor-arg>
        <constructor-arg>
            <ref bean="naturalJoin"/>
        </constructor-arg>
        <constructor-arg>
            <ref bean="outerUnion"/>
        </constructor-arg>
    </bean>

    <bean id="fullOuterJoin" class="org.jrdf.query.relation.operation.mem.join.outer.FullOuterJoinImpl">
        <constructor-arg>
            <ref bean="leftOuterJoin"/>
        </constructor-arg>
        <constructor-arg>
            <ref bean="outerUnion"/>
        </constructor-arg>
        <constructor-arg>
            <ref bean="antiJoin"/>
        </constructor-arg>
    </bean>

    <bean id="minFullOuterJoin" class="org.jrdf.query.relation.operation.mem.union.MinimumUnionFullOuterJoinImpl">
        <constructor-arg>
            <ref bean="naturalJoin"/>
        </constructor-arg>
        <constructor-arg>
            <ref bean="minimumUnion"/>
        </constructor-arg>
    </bean>

    <bean id="minLeftOuterJoin" class="org.jrdf.query.relation.operation.mem.union.MinimumUnionLeftOuterJoinImpl">
        <constructor-arg>
            <ref bean="naturalJoin"/>
        </constructor-arg>
        <constructor-arg>
            <ref bean="minimumUnion"/>
        </constructor-arg>
    </bean>
</beans>