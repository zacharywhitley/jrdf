<!-- tested using ant 1.5.4 -->
<project name="jrdf" default="dist" basedir=".">

    <property name="Name"            value="Java RDF API"/>
    <property name="name"            value="jrdf"/>
    
    <!-- The major and minor version numbers  -->
    <property name="version-major"   value="0"/>
    <property name="version-minor"   value="3.2"/>

    <!-- e.g. -0.2, or empty string for stable releases -->
    <property name="version-status"  value=""/>
    <property name="version"
         value="${version-major}.${version-minor}${version-status}"/>

    <property name="dist.name"       value="${Name}-${version}"/>
    
    <property name="web.site"        value="http://jrdf.sourceforge.net/" />
  
    <property name="debug"           value="true"/>
    <property name="debuglevel"      value="source,lines"/>
    <property name="deprecation"     value="false"/>
    <property name="optimize"        value="true"/>

    <property name="src.dir"         value="src"/>
    <property name="obj.dir"         value="obj"/>
    <property name="classes.dir"     value="obj/java/classes"/>
    <property name="dist.dir"        value="dist"/>
    <property name="lib.dir"         value="lib"/>
    <property name="doc.dir"         value="doc"/>
    <property name="javadoc.dir"     value="doc/javadoc"/>
    <property name="junit.results.dir" value="tests"/>
    <property name="junit.results" value="${junit.results.dir}/All-Tests.xml"/>

    <property name="jarfile"         value="${name}-${version}.jar"/>

    <target name="compile">
      <delete dir="${classes.dir}"/>
      <mkdir dir="${classes.dir}"/>
      <javac source="1.4"
             classpath="${lib.dir}/junit-3.8.1.jar"
             srcdir="${src.dir}"
             destdir="${classes.dir}"
             debug="${debug}"
             debuglevel="${debuglevel}"
             deprecation="${deprecation}"
             optimize="${optimize}">
      </javac>
    </target>

    <target name="dist" depends="compile">
      <delete dir="${dist.dir}"/>
      <mkdir dir="${dist.dir}"/>
      <jar jarfile="${dist.dir}/${jarfile}"
           basedir="${classes.dir}">
      </jar>
    </target>

    <target name="javadoc">
      <delete dir="${javadoc.dir}"/>
      <mkdir dir="${javadoc.dir}"/>

      <javadoc
       source="1.4"
       sourcepath="${src.dir}"
       destdir="${javadoc.dir}"
       author="true"
       version="true"
       windowtitle="${Name} Framework"
       doctitle="${Name} Framework"
       packagenames="org.jrdf.graph, org.jrdf.util, org.jrdf.vocabulary,
       org.jrdf.graph.mem"
       additionalparam="-breakiterator"
       Use="true"
    />
    </target>

    <target name="clean">
      <delete dir="${dist.dir}"/>
      <delete dir="${obj.dir}"/>
      <delete dir="${javadoc.dir}"/>
      <delete dir="${junit.results.dir}"/>
    </target>

    <target name="test" depends="dist" description="Runs unit tests">
      <delete dir="${junit.results.dir}"/>
      <mkdir dir="${junit.results.dir}"/>
      <delete file="${junit.results}"/>

      <junit haltonfailure="no" printsummary="on">
        <classpath>
          <fileset dir="${lib.dir}" includes="*.jar"/>
          <fileset dir="${dist.dir}" includes="*.jar"/>
        </classpath>
        <formatter type="plain"/>
        <batchtest todir="${junit.results.dir}">
          <fileset dir="${src.dir}" includes="**/*UnitTest.java"
            excludes="**/Abstract*" />
        </batchtest>
      </junit>

    </target>
</project>
